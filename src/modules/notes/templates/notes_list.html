{% extends "layout.html" %}
{% block module_content %}
  <div>
    <a href="{{ url_for('notes.list_notes_table_route', proj=project) }}">Table</a> |
    <a href="{{ url_for('notes.list_notes_list_route', proj=project) }}">List</a> |
    <a href="{{ url_for('notes.list_notes_cards_route', proj=project) }}">Card</a>
  </div>
  <a href="#" class="new-note-btn" data-sidebar-label="{{ project or '' }}">New Note</a>
  <a href="{{ url_for('notes.import_notes_folder_route', proj=project) }}">Import Folder</a>

{% set link_list_type = "note" %}
{% set link_list_context_id = "notes_list" %}
{% set link_table_id = "notes-table" %}
{% include "widgets/links_bulk_toolbar.html" %}

<table border="1" cellpadding="5" id="notes-table" data-notes-context="true">
  <tr>
    <th><input type="checkbox" class="link-select-all"></th>
    {% set dir_file = 'asc' if sort_col != 'file_name' or sort_dir == 'desc' else 'desc' %}
    {% set dir_path = 'asc' if sort_col != 'path' or sort_dir == 'desc' else 'desc' %}
    {% set dir_folder_id = 'asc' if sort_col != 'folder_id' or sort_dir == 'desc' else 'desc' %}
    {% set dir_size = 'asc' if sort_col != 'size' or sort_dir == 'desc' else 'desc' %}
    {% set dir_project = 'asc' if sort_col != 'project' or sort_dir == 'desc' else 'desc' %}
    {% set dir_derived = 'asc' if sort_col != 'derived_project' or sort_dir == 'desc' else 'desc' %}
    {% set dir_modified = 'asc' if sort_col != 'date_modified' or sort_dir == 'desc' else 'desc' %}
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='file_name', dir=dir_file) }}">File</a>
      {% if sort_col == 'file_name' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='path', dir=dir_path) }}">Path</a>
      {% if sort_col == 'path' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='folder_id', dir=dir_folder_id) }}">Folder ID</a>
      {% if sort_col == 'folder_id' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='size', dir=dir_size) }}">Size</a>
      {% if sort_col == 'size' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='project', dir=dir_project) }}">Project</a>
      {% if sort_col == 'project' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='derived_project', dir=dir_derived) }}">Derived</a>
      {% if sort_col == 'derived_project' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>
      <a href="{{ url_for(route_name, proj=project, sort='date_modified', dir=dir_modified) }}">Modified</a>
      {% if sort_col == 'date_modified' %} {{ '^' if sort_dir == 'asc' else 'v' }}{% endif %}
    </th>
    <th>Actions</th>
  </tr>
  {% for n in notes %}
  <tr class="link-draggable" data-record-type="note" data-record-id="{{ n.id }}" data-record-title="{{ n.file_name }}">
    <td><input type="checkbox" class="link-select" data-record-type="note" data-record-id="{{ n.id }}" data-record-title="{{ n.file_name }}"></td>
    <td><a href="{{ url_for('notes.view_note_route', note_id=n.id) }}">{{ n.file_name }}</a></td>
    <td>{{ n.path }}</td>
    <td>{{ n.folder_id }}</td>
    <td>{{ n.size }}</td>
    <td>{{ n.project }}</td>
    <td>{{ n.derived_project }}</td>
    <td>{{ n.date_modified or n.updated.strftime('%Y-%m-%d %H:%M') }}</td>
    <td>
      <a href="{{ url_for('notes.edit_note_route', note_id=n.id) }}">Edit</a> |
      <a href="{{ url_for('notes.delete_note_route', note_id=n.id) }}" onclick="return confirm('Delete note?');">Del</a>
    </td>
  </tr>
  {% endfor %}
</table>
  {% include "widgets/wid_pagination.html" %}
{% endblock %}
